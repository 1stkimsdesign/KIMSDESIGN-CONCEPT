<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ ë””ìì¸ ì»¨ì…‰ ê¸°íš ìƒì„±ê¸° | KIMSDESIGN</title>
<meta name="description" content="ëª©ì Â·íƒ€ê²ŸÂ·ë¬´ë“œÂ·í†¤ì•¤ë§¤ë„ˆë¥¼ ì…ë ¥í•˜ë©´ ìƒ‰ì±„/íƒ€ì´í¬/ê·¸ë¦¬ë“œ/ë©”ì‹œì§€/CTAê¹Œì§€ ìë™ìœ¼ë¡œ ì •ë¦¬ëœ ë””ìì¸ ì»¨ì…‰ ê¸°íšì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.">
<style>
:root{
  --bg:#ffffff; --fg:#0b0b0c; --muted:#6b7280; --line:#e5e7eb; --card:#f8fafc;
  --accent:#2563eb; --ok:#16a34a; --bad:#ef4444;
}
*{box-sizing:border-box}
html,body{margin:0}
body{font-family:ui-sans-serif,system-ui,Apple SD Gothic Neo,Pretendard,Roboto,Helvetica,Arial;background:var(--bg);color:var(--fg)}
header{position:sticky;top:0;background:#ffffffc0;backdrop-filter:saturate(1.05) blur(8px);border-bottom:1px solid var(--line);z-index:30}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
.brand{display:flex;align-items:center;gap:12px;font-weight:900}
.badge{font-size:12px;color:#334155;border:1px solid var(--line);background:#eef2ff;padding:4px 10px;border-radius:999px}
.grid{display:grid;gap:14px}
.panel{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px}
h2{margin:0 0 8px 0}
h3{margin:0 0 8px 0}
p{margin:6px 0}
label{font-weight:600}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.input{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
.select{padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
.small{font-size:12px;color:var(--muted)}
.btn{padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:linear-gradient(#fff,#f3f4f6);cursor:pointer}
.btn.primary{background:linear-gradient(180deg,#93c5fd,#60a5fa);border-color:transparent;font-weight:800}
.btn.ghost{background:#fff}
.kbd{border:1px solid var(--line);padding:2px 6px;border-radius:6px;background:#fff}
hr.sep{border:0;border-top:1px dashed var(--line);margin:12px 0}
.col2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width: 920px){ .col2{grid-template-columns:1fr} }

.chips{display:flex;gap:8px;flex-wrap:wrap}
.chips .chip{padding:8px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;cursor:pointer}
.chips .chip.active{background:#1d4ed8;color:#fff;border-color:#1d4ed8}
.swatch{display:flex;gap:10px;flex-wrap:wrap}
.swatch .c{width:78px;border:1px solid var(--line);border-radius:10px;overflow:hidden;background:#fff}
.swatch .c div{height:42px}
.swatch .c span{display:block;padding:6px 6px 8px;font-size:11px;text-align:center;color:#334155;word-break:break-all}

.preview{border:1px solid var(--line);border-radius:14px;overflow:hidden}
.preview .hero{padding:20px;background:#fff}
.preview .hero h1{margin:0;font-size:26px}
.preview .hero p{color:var(--muted)}
.preview .cta{display:inline-block;margin-top:10px;padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:#111;color:#fff}
.preview .grid{grid-template-columns:repeat(3,1fr)}
.tag{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;color:#334155;font-size:12px}
.code{white-space:pre-wrap;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#0b0b0c; color:#e5e7eb;border-radius:12px;padding:12px; border:1px solid #111}
.notice{padding:10px;border:1px dashed var(--line);border-radius:12px;background:#fff}
footer{margin:28px 0 10px;text-align:center;color:var(--muted);font-size:12px}
</style>
</head>
<body>

<header>
  <div class="wrap brand">
    <div style="font-size:22px">ğŸ ë””ìì¸ ì»¨ì…‰ ê¸°íš ìƒì„±ê¸°</div>
    <span class="badge">ëª©ì â†’íƒ€ê²Ÿâ†’ë¬´ë“œâ†’í†¤â†’ìƒ‰ì±„/íƒ€ì´í¬/ê·¸ë¦¬ë“œ ìë™ ì¶”ì²œ</span>
  </div>
</header>

<div class="wrap grid">

  <!-- ì…ë ¥ ì„¹ì…˜ -->
  <section class="panel grid">
    <h2>1) ê¸°ë³¸ ì •ë³´</h2>
    <div class="col2">
      <div>
        <label>í”„ë¡œì íŠ¸ëª…</label>
        <input id="projName" class="input" placeholder="ì˜ˆ) ë”í‚´ ìœ ë‹ˆë²„ìŠ¤ ëœë”© í˜ì´ì§€">
      </div>
      <div>
        <label>ì‚°ì—…êµ°</label>
        <select id="industry" class="select">
          <option>í…Œí¬/ìŠ¤íƒ€íŠ¸ì—…</option><option>êµìœ¡</option><option>íŒ¨ì…˜/ë·°í‹°</option>
          <option>í‘¸ë“œ/ë ˆìŠ¤í† ë‘</option><option>ê¸ˆìœµ/í•€í…Œí¬</option><option>ë¬¸í™”/ì „ì‹œ</option>
          <option>ê±´ê°•/í—¬ìŠ¤ì¼€ì–´</option>
        </select>
      </div>
    </div>
    <div class="col2">
      <div>
        <label>ëª©ì </label>
        <select id="purpose" class="select">
          <option value="awareness">ë¸Œëœë“œ ì¸ì§€ë„ í–¥ìƒ</option>
          <option value="conversion">ì „í™˜/ê°€ì…/ë‹¤ìš´ë¡œë“œ</option>
          <option value="education">êµìœ¡/ì„¤ëª…</option>
          <option value="campaign">í”„ë¡œëª¨ì…˜/ìº í˜ì¸</option>
          <option value="info">ì •ë³´ ì „ë‹¬/ì†Œê°œ</option>
        </select>
      </div>
      <div>
        <label>í”Œë«í¼</label>
        <select id="platform" class="select">
          <option value="web">ì›¹/ëœë”© í˜ì´ì§€</option>
          <option value="app">ëª¨ë°”ì¼ ì•±</option>
          <option value="poster">í¬ìŠ¤í„°/ì¸ì‡„</option>
          <option value="sns">SNS ì¹´ë“œ/ë°°ë„ˆ</option>
        </select>
      </div>
    </div>
    <div class="col2">
      <div>
        <label>íƒ€ê²Ÿ(ìš”ì•½)</label>
        <input id="audience" class="input" placeholder="ì˜ˆ) 20-30ëŒ€ ì–¼ë¦¬ì–´ë‹µí„°, ì‹¤ìš©ì /ë¯¸ë‹ˆë©€ ì·¨í–¥">
      </div>
      <div>
        <label>í•µì‹¬ ë©”ì‹œì§€</label>
        <input id="keyMsg" class="input" placeholder="ì˜ˆ) 3ë¶„ë§Œì— ì „ë¬¸ê°€ í¬íŠ¸í´ë¦¬ì˜¤ ì™„ì„±">
      </div>
    </div>
    <div>
      <label>í•µì‹¬ í‚¤ì›Œë“œ(ì‰¼í‘œ êµ¬ë¶„)</label>
      <input id="keywords" class="input" placeholder="ì˜ˆ) ëª¨ë˜, ì‹ ë¢°, ì§ê´€ì , ë¹ ë¥¸, í™•ì¥ì„±">
    </div>
  </section>

  <section class="panel grid">
    <h2>2) ë¬´ë“œ & í†¤</h2>
    <div>
      <label>ë¬´ë“œ ì„ íƒ</label>
      <div id="moodChips" class="chips">
        <!-- JSê°€ ì±„ì›€ -->
      </div>
      <div class="small">ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥</div>
    </div>
    <div>
      <label>í†¤ì•¤ë§¤ë„ˆ</label>
      <div id="toneChips" class="chips">
        <!-- JSê°€ ì±„ì›€ -->
      </div>
    </div>
  </section>

  <section class="panel grid">
    <h2>3) ìƒ‰ì±„/íƒ€ì´í¬/ë ˆì´ì•„ì›ƒ ê¸°ë³¸</h2>
    <div class="col2">
      <div>
        <label>í‚¤ ì»¬ëŸ¬</label>
        <div class="row">
          <input id="keyColor" type="color" value="#2563eb" class="input" style="width:120px;padding:4px">
          <button class="btn" id="btnPal">ê¸°ë¶„ì— ë§ê²Œ íŒ”ë ˆíŠ¸ ì œì•ˆ</button>
          <button class="btn ghost" id="btnRand">ëœë¤</button>
        </div>
        <div class="swatch" id="swatches" style="margin-top:10px"></div>
        <div id="contrastNote" class="small"></div>
      </div>
      <div>
        <label>íƒ€ì´í¬ ì„ í˜¸</label>
        <div class="chips" id="typoChips"></div>
        <div class="small">ë³¸ë¬¸: ê°€ë…ì„± ìœ„ì£¼ Â· í—¤ë“œë¼ì¸: ê°•ì¡°/ê°œì„±</div>
        <hr class="sep">
        <label>ë ˆì´ì•„ì›ƒ/ê·¸ë¦¬ë“œ</label>
        <div class="chips" id="gridChips"></div>
      </div>
    </div>
  </section>

  <section class="panel grid">
    <h2>4) ì œì•½ ì‚¬í•­ (ì„ íƒ)</h2>
    <div class="col2">
      <div>
        <label>ê¸ˆì§€ ìš”ì†Œ</label>
        <input id="ban" class="input" placeholder="ì˜ˆ) ë„¤ì˜¨ ê·¸ë¼ë””ì–¸íŠ¸, ê³¼í•œ ê·¸ë¦¼ì, ë¼ìš´ë“œ ëª¨ì„œë¦¬">
      </div>
      <div>
        <label>ì ‘ê·¼ì„±/ìš´ì˜ ë©”ëª¨</label>
        <input id="notes" class="input" placeholder="ì˜ˆ) ëª…ë„ ëŒ€ë¹„ 4.5:1 ì´ìƒ, ëª¨ë°”ì¼ ìš°ì„ , ë ˆê±°ì‹œ ë¸Œë¼ìš°ì € ì œì™¸">
      </div>
    </div>
  </section>

  <section class="panel grid">
    <div class="row" style="justify-content:space-between">
      <div class="notice">ì…ë ¥ ì™„ë£Œ í›„ <span class="kbd">ìƒì„±í•˜ê¸°</span>ë¥¼ ëˆ„ë¥´ë©´ ê¸°íšì„œê°€ ìƒì„±ë¼ìš”.</div>
      <div class="row">
        <button class="btn" onclick="resetAll()">ì´ˆê¸°í™”</button>
        <button class="btn primary" onclick="generate()">ìƒì„±í•˜ê¸° â–¶</button>
      </div>
    </div>
  </section>

  <!-- ê²°ê³¼ -->
  <section id="outSec" class="panel grid" style="display:none">
    <div class="row" style="justify-content:space-between">
      <h2>ğŸ¯ ìƒì„±ëœ ë””ìì¸ ì»¨ì…‰ ê¸°íšì„œ</h2>
      <div class="row">
        <button class="btn" onclick="copyPlan()">ë³µì‚¬</button>
        <button class="btn" onclick="downloadMD()">Markdown ì €ì¥</button>
        <button class="btn" onclick="window.print()">ì¸ì‡„/PDF</button>
      </div>
    </div>

    <div id="preview" class="preview">
      <div class="hero" id="heroPrev">
        <div class="tag" id="tagMood">#ëª¨ë˜ #ë¯¸ë‹ˆë©€</div>
        <h1 id="heroTitle">í”„ë¡œì íŠ¸ íƒ€ì´í‹€</h1>
        <p id="heroLead">í•µì‹¬ ë©”ì‹œì§€ ë¯¸ë¦¬ë³´ê¸°â€¦</p>
        <span class="cta" id="heroCTA">ì§€ê¸ˆ ì‹œì‘í•˜ê¸°</span>
      </div>
    </div>

    <div id="plan" class="grid"></div>
  </section>

  <footer>â€» ë³¸ í˜ì´ì§€ëŠ” ê¹€ì”¨ë„¤ë””ìì¸ì‹¤ì˜ ìì²´ ì œì‘ ë„êµ¬ë¡œ, ë¬´ë‹¨ ë³µì œ ë° ë°°í¬ë¥¼ ê¸ˆí•©ë‹ˆë‹¤.</footer>
</div>

<script>
/* =============================
   ë°ì´í„° ë§µ (ë¬´ë“œ/í†¤ â†’ íŒ”ë ˆíŠ¸/íƒ€ì´í¬/ë ˆì´ì•„ì›ƒ ë§¤í•‘)
============================= */
const MOODS = [
  {id:'modern', label:'ëª¨ë”ë‹ˆì¦˜', colors:['#111827','#2563eb','#e5e7eb','#0ea5e9','#f8fafc']},
  {id:'retro', label:'ë ˆíŠ¸ë¡œ', colors:['#5b3a29','#eab308','#ef4444','#fde68a','#f3e8ff']},
  {id:'brutal', label:'ë¸Œë£¨íƒˆë¦¬ì¦˜', colors:['#000000','#22c55e','#facc15','#e11d48','#ffffff']},
  {id:'minimal', label:'ë¯¸ë‹ˆë©€', colors:['#0f172a','#94a3b8','#f1f5f9','#334155','#e2e8f0']},
  {id:'pop', label:'íŒ/ìºì£¼ì–¼', colors:['#111827','#f43f5e','#fb923c','#22d3ee','#fef3c7']},
  {id:'warm', label:'ì›œ/íœ´ë¨¼', colors:['#1f2937','#d97706','#b45309','#fde68a','#fdf2f8']},
  {id:'nature', label:'ë„¤ì´ì³', colors:['#0b3d2e','#16a34a','#8b5cf6','#84cc16','#f0fdf4']},
  {id:'tech', label:'í…Œí¬/ì‚¬ì´ë²„', colors:['#0b0b0c','#22d3ee','#60a5fa','#a78bfa','#111827']},
];
const TONES = ['ì„¸ë ¨ëœ','ì¹œê·¼í•œ','ëŒ€ë‹´í•œ','ë”°ëœ»í•œ','ì‹ ë¢°ê°','í˜ì‹ ì ','ì°¨ë¶„í•œ','ê²½ì¾Œí•œ'];

const TYPO_PREFS = [
  {id:'body-sans', label:'ë³¸ë¬¸: ì‚°ì„¸ë¦¬í”„(ê°€ë³€í­/ê°€ë…ì„±)'},
  {id:'body-serif', label:'ë³¸ë¬¸: ì„¸ë¦¬í”„(ì„œì‚¬/ì‹ ë¢°)'},
  {id:'display-strong', label:'í—¤ë“œë¼ì¸: êµµê²Œ/ì½˜ë´ìŠ¤ë“œ'},
  {id:'display-soft', label:'í—¤ë“œë¼ì¸: ë‘¥ê¸€ê³  ì¹œê·¼'},
];
const GRID_PREFS = [
  {id:'grid-12', label:'12 ì»¬ëŸ¼ ì›¹ ê·¸ë¦¬ë“œ'},
  {id:'grid-8', label:'8 ì»¬ëŸ¼ (ë°ìŠ¤í¬í†±/í¬ìŠ¤í„°)'},
  {id:'grid-modular', label:'ëª¨ë“ˆëŸ¬ ê·¸ë¦¬ë“œ (ì¹´ë“œ/ëŒ€ì‹œë³´ë“œ)'},
  {id:'grid-baseline', label:'ë² ì´ìŠ¤ë¼ì¸ 4/8pt ìŠ¤ì¼€ì¼'},
];

const TYPO_PAIRING = {
  'body-sans+display-strong': {body:'Pretendard/Inter', head:'Bebas/Condensed Sans', lead:1.6},
  'body-sans+display-soft': {body:'Pretendard/Inter', head:'Rounded Sans', lead:1.7},
  'body-serif+display-strong': {body:'Noto Serif/Source Serif', head:'Strong Sans', lead:1.65},
  'body-serif+display-soft': {body:'Noto Serif/Source Serif', head:'Rounded Sans', lead:1.7},
};

const INDUSTRY_IMAGERY = {
  'í…Œí¬/ìŠ¤íƒ€íŠ¸ì—…':['ëŒ€ì‹œë³´ë“œ ì¸í„°í˜ì´ìŠ¤','ë“±ì¥ ëª¨ì…˜','ëª¨ë“ˆí˜• ì¹´ë“œ','ì½”ë“œ/ë„¤íŠ¸ì›Œí¬ ë©”íƒ€í¬'],
  'êµìœ¡':['êµì¬ ì§ˆê°','ì°¨íŠ¸/ë„í‘œ','ì¹œê·¼í•œ ì¼ëŸ¬ìŠ¤íŠ¸','í•™ìŠµ UI'],
  'íŒ¨ì…˜/ë·°í‹°':['ë£©ë¶ í¬ë¡­','ì§ˆê° í´ë¡œì¦ˆì—…','í•˜ì´ì»¨íŠ¸ë¼ìŠ¤íŠ¸ ì¡°ëª…','ëª¨ë…¸í†¤'],
  'í‘¸ë“œ/ë ˆìŠ¤í† ë‘':['ì‹ì¬ë£Œ í´ë¡œì¦ˆì—…','ë”°ëœ»í•œ ì¡°ëª…','ì†ê¸€ì”¨ ì•…ì„¼íŠ¸','ë©”ë‰´ ì¹´ë“œ'],
  'ê¸ˆìœµ/í•€í…Œí¬':['ì‹ ë¢° ì»¬ëŸ¬','ì°¨ë¶„í•œ ì•„ì´ì½˜','ë°ì´í„° ì‹œê°í™”','ì¼€ì´ìŠ¤ ìŠ¤í„°ë””'],
  'ë¬¸í™”/ì „ì‹œ':['í¬ìŠ¤í„° íƒ€ì´í¬','ê·¸ë¦¬ë“œ ì‹¤í—˜','í…ìŠ¤ì²˜ ë ˆì´ì–´','ëŒ€ë‹´í•œ ì—¬ë°±'],
  'ê±´ê°•/í—¬ìŠ¤ì¼€ì–´':['ì²­ê²°í•œ í™”ì´íŠ¸','ë¶€ë“œëŸ¬ìš´ íŒŒìŠ¤í…”','ì¸í¬ê·¸ë˜í”½','ì•ˆì •ê° ìˆëŠ” ì‚¬ì§„']
};

const CTA_BY_PURPOSE = {
  awareness:['ë” ì•Œì•„ë³´ê¸°','ìŠ¤í† ë¦¬ ë³´ëŸ¬ê°€ê¸°','ì œí’ˆ ì² í•™ ë³´ê¸°'],
  conversion:['ì§€ê¸ˆ ì‹œì‘í•˜ê¸°','ë¬´ë£Œë¡œ ì²´í—˜','ì•± ë‹¤ìš´ë¡œë“œ'],
  education:['ê°€ì´ë“œ ì½ê¸°','íŠœí† ë¦¬ì–¼ ë³´ê¸°','ìƒ˜í”Œ í™•ì¸'],
  campaign:['ì´ë²¤íŠ¸ ì°¸ì—¬','í˜œíƒ ë°›ê¸°','ì¿ í° ë°›ê¸°'],
  info:['ìƒì„¸ ì •ë³´','ìŠ¤í™ í™•ì¸','ê³ ê° ì‚¬ë¡€ ë³´ê¸°']
};

/* =============================
   ìœ í‹¸
============================= */
function $(sel){return document.querySelector(sel)}
function el(tag,attrs={},html=''){ const e=document.createElement(tag); Object.assign(e,attrs); if(html) e.innerHTML=html; return e; }

function hexToRgb(hex){hex=hex.replace('#',''); if(hex.length===3) hex=[hex[0],hex[0],hex[1],hex[1],hex[2],hex[2]].join(''); const num=parseInt(hex,16); return {r:(num>>16)&255,g:(num>>8)&255,b:num&255}}
function luminance({r,g,b}){ // sRGB â†’ lin
  const srgb=[r/255,g/255,b/255].map(v=>v<=0.03928?v/12.92:((v+0.055)/1.055)**2.4);
  return 0.2126*srgb[0]+0.7152*srgb[1]+0.0722*srgb[2];
}
function contrast(hex1,hex2){
  const L1=luminance(hexToRgb(hex1)), L2=luminance(hexToRgb(hex2));
  const [a,b]=L1>L2?[L1,L2]:[L2,L1];
  return (a+0.05)/(b+0.05);
}
function clamp(n,min,max){return Math.min(max,Math.max(min,n))}
function lighten(hex,amt){ // amt:-1~+1
  const {r,g,b}=hexToRgb(hex); const f=(x)=>clamp(Math.round(x+(255-x)*amt),0,255);
  const h=(n)=>n.toString(16).padStart(2,'0');
  return '#'+h(f(r))+h(f(g))+h(f(b));
}
function download(filename, text){
  const a=document.createElement('a'); a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(text); a.download=filename; a.click();
}

/* =============================
   ì´ˆê¸° UI êµ¬ì„±
============================= */
function buildChips(box, items){
  items.forEach(idOrObj=>{
    const id=typeof idOrObj==='string'?idOrObj:idOrObj.id;
    const label=typeof idOrObj==='string'?idOrObj:idOrObj.label;
    const chip=el('button',{className:'chip',type:'button',onclick(){chip.classList.toggle('active');}});
    chip.textContent=label; chip.dataset.id=id;
    box.appendChild(chip);
  });
}
// ë¬´ë“œ/í†¤/íƒ€ì´í¬/ê·¸ë¦¬ë“œ
buildChips($('#moodChips'), MOODS);
buildChips($('#toneChips'), TONES);
buildChips($('#typoChips'), TYPO_PREFS);
buildChips($('#gridChips'), GRID_PREFS);

// ê¸°ë³¸ íŒ”ë ˆíŠ¸ ë…¸ì¶œ
function setSwatchesFromMood(){
  const moodSel=[...$('#moodChips').querySelectorAll('.chip.active')].map(c=>c.dataset.id);
  const mood = MOODS.find(m=>m.id=== (moodSel[0]||'modern')) || MOODS[0];
  const key = $('#keyColor').value;
  const pal=[key, ...mood.colors.filter(c=>c.toLowerCase()!==key.toLowerCase())].slice(0,5);
  drawSwatches(pal);
}
function drawSwatches(pal){
  const box=$('#swatches'); box.innerHTML='';
  pal.forEach(hex=>{
    const card=el('div',{className:'c'});
    card.innerHTML=`<div style="background:${hex}"></div><span>${hex.toUpperCase()}</span>`;
    box.appendChild(card);
  });
  // ëŒ€ë¹„ ì½”ë©˜íŠ¸
  const bg=pal[pal.length-1], text='#111111', contrastRatio=contrast(bg,text).toFixed(2);
  $('#contrastNote').innerHTML=`<span class="tag">ì ‘ê·¼ì„±</span> ë³¸ë¬¸ ëŒ€ë¹„(ì˜ˆì‹œ) ${contrastRatio}:1 â€” WCAG AA ë³¸ë¬¸ ê¸°ì¤€ 4.5:1 ì´ìƒ ê¶Œì¥`;
}
setSwatchesFromMood();

// íŒ”ë ˆíŠ¸ ë²„íŠ¼
$('#btnPal').onclick=setSwatchesFromMood;
$('#btnRand').onclick=()=>{
  $('#keyColor').value = '#'+Math.floor(Math.random()*0xffffff).toString(16).padStart(6,'0');
  setSwatchesFromMood();
};

/* =============================
   ìƒì„± ë¡œì§
============================= */
function getActiveIds(containerSel){
  return [...$(containerSel).querySelectorAll('.chip.active')].map(c=>c.dataset.id);
}
function pairTypography(){
  const t = getActiveIds('#typoChips');
  const body = t.includes('body-serif') ? 'Noto Serif/Source Serif' : 'Pretendard/Inter';
  const head =
    t.includes('display-strong') ? (t.includes('body-serif') ? 'Strong Sans' : 'Bebas/Condensed Sans') :
    t.includes('display-soft') ? 'Rounded Sans' : 'Strong Sans';
  const key = (t.includes('body-serif')?'body-serif':'body-sans')+'+'+(t.includes('display-soft')?'display-soft':'display-strong');
  const spec = TYPO_PAIRING[key] || {lead:1.65};
  return {body, head, lead: spec.lead||1.65};
}
function chooseGrid(platform){
  const picks = getActiveIds('#gridChips');
  if(picks.length){ return picks.map(id=>GRID_PREFS.find(g=>g.id===id)?.label).filter(Boolean); }
  if(platform==='web') return ['12 ì»¬ëŸ¼ ì›¹ ê·¸ë¦¬ë“œ','ë² ì´ìŠ¤ë¼ì¸ 4/8pt'];
  if(platform==='app') return ['ëª¨ë“ˆëŸ¬ ê·¸ë¦¬ë“œ','ë² ì´ìŠ¤ë¼ì¸ 4/8pt'];
  if(platform==='poster') return ['8 ì»¬ëŸ¼','ëª¨ë“ˆëŸ¬ ê·¸ë¦¬ë“œ'];
  return ['12 ì»¬ëŸ¼','ë² ì´ìŠ¤ë¼ì¸ 4/8pt'];
}
function toneToWords(toneList){
  if(!toneList.length) return 'ì„¸ë ¨ëœ Â· ì‹ ë¢°ê°';
  return toneList.join(' Â· ');
}
function buildPalette(){
  const moodSel = getActiveIds('#moodChips');
  const mood = MOODS.find(m=>m.id=== (moodSel[0]||'modern')) || MOODS[0];
  const key = $('#keyColor').value;
  // ê¸°ë³¸: key + mood íŒŒë ˆíŠ¸ì—ì„œ 4ê°œ
  const pal = [key, ...mood.colors.filter(c=>c.toLowerCase()!==key.toLowerCase()).slice(0,4)];
  return {moodLabel: mood.label, colors: pal};
}
function planMarkdown(data){
  const {name, purposeLabel, platformLabel, audience, msg, moodLabel, tones, palette, typo, grid, industry, keywords, imagery, bans, notes, cta, tagline} = data;
  const palList = palette.colors.map(c=>`- ${c}`).join('\n');
  const gridList = grid.map(g=>`- ${g}`).join('\n');
  const imgList = imagery.map(s=>`- ${s}`).join('\n');
  return `# ${name}
> ëª©ì : **${purposeLabel}** Â· í”Œë«í¼: **${platformLabel}** Â· íƒ€ê²Ÿ: **${audience}**  
> í†¤ì•¤ë§¤ë„ˆ: **${tones}** Â· ë¬´ë“œ: **${moodLabel}**

## 1. ì „ëµ ìš”ì•½
- í•µì‹¬ ë©”ì‹œì§€: **${msg}**
- í•µì‹¬ í‚¤ì›Œë“œ: ${keywords}

## 2. ë¹„ì£¼ì–¼ ë””ë ‰ì…˜
- ë¬´ë“œ: **${moodLabel}**
- í†¤ì•¤ë§¤ë„ˆ: **${tones}**
- ìƒ‰ì±„ íŒ”ë ˆíŠ¸  
${palList}

## 3. íƒ€ì´í¬ê·¸ë˜í”¼
- ë³¸ë¬¸: ${typo.body}
- í—¤ë“œë¼ì¸: ${typo.head}
- ê¶Œì¥ ë¦¬ë”©(Line-height): ${typo.lead}

## 4. ë ˆì´ì•„ì›ƒ/ê·¸ë¦¬ë“œ
${gridList}

## 5. ì¹´í”¼/ë©”ì‹œì§€
- ì œì•ˆ CTA: **${cta}**
- ì œì•ˆ íƒœê·¸ë¼ì¸: **${tagline}**

## 6. ì´ë¯¸ì§€/ì•„ì´ì½˜ ë°©í–¥ (${industry})
${imgList}

## 7. ì œì•½/ìš´ì˜
- ê¸ˆì§€ ìš”ì†Œ: ${bans||'-'}
- ì ‘ê·¼ì„±/ìš´ì˜ ë©”ëª¨: ${notes||'-'}
`;
}

/* CTA / íƒœê·¸ë¼ì¸ ê°„ë‹¨ ìƒì„±ê¸° */
function suggestCTA(purpose){ const arr = CTA_BY_PURPOSE[purpose]||CTA_BY_PURPOSE.info; return arr[Math.floor(Math.random()*arr.length)] }
function makeTagline(keyMsg, tones){
  const t = tones.length? tones[0] : 'ì„¸ë ¨ëœ';
  const verbs = {ì„¸ë ¨ëœ:'ë” ë˜‘ë˜‘í•˜ê²Œ', ì¹œê·¼í•œ:'ì‰½ê³  í¸í•˜ê²Œ', ëŒ€ë‹´í•œ:'ê°•ë ¬í•˜ê²Œ', ë”°ëœ»í•œ:'ë”°ìŠ¤í•˜ê²Œ', ì‹ ë¢°ê°:'ì•ˆì „í•˜ê²Œ', í˜ì‹ ì :'ìƒˆë¡­ê²Œ', ì°¨ë¶„í•œ:'ì¡°ìš©íˆ', ê²½ì¾Œí•œ:'ê°€ë³ê²Œ'};
  return `${verbs[t]||'ë” ë˜‘ë˜‘í•˜ê²Œ'} â€” ${keyMsg.replace(/[.!?]$/,'')}`;
}

function generate(){
  const name = $('#projName').value || 'ë¬´ì œ í”„ë¡œì íŠ¸';
  const industry = $('#industry').value;
  const purpose = $('#purpose').value;
  const platform = $('#platform').value;
  const purposeLabel = $('#purpose').selectedOptions[0].textContent;
  const platformLabel = $('#platform').selectedOptions[0].textContent;
  const audience = $('#audience').value || 'ì¼ë°˜ ëŒ€ì¤‘';
  const msg = $('#keyMsg').value || 'í•µì‹¬ ë©”ì‹œì§€ë¥¼ ì—¬ê¸°ì— ì…ë ¥';
  const keywords = $('#keywords').value || '';
  const tonesSel = getActiveIds('#toneChips').map(id=>id);
  const tones = toneToWords(tonesSel);
  const palette = buildPalette();
  const typo = pairTypography();
  const grid = chooseGrid(platform);
  const imagery = INDUSTRY_IMAGERY[industry] || [];
  const bans = $('#ban').value;
  const notes = $('#notes').value;
  const cta = suggestCTA(purpose);
  const tagline = makeTagline(msg, tonesSel);

  // í”„ë¦¬ë·° ì—…ë°ì´íŠ¸
  $('#heroTitle').textContent = name;
  $('#heroLead').textContent = msg;
  $('#heroCTA').textContent = cta;
  $('#tagMood').textContent = `#${palette.moodLabel} Â· ${tones}`;
  const heroBg = palette.colors[palette.colors.length-1];
  const heroText = contrast(heroBg,'#111111')>=4.5 ? '#111' : '#fff';
  $('#heroPrev').style.background = heroBg;
  $('#heroPrev').style.color = heroText;
  $('#heroPrev').querySelector('.cta').style.background = palette.colors[0];

  // íŒ”ë ˆíŠ¸ ë‹¤ì‹œ ê·¸ë¦¼
  drawSwatches(palette.colors);

  // ê¸°íšì„œ ë³¸ë¬¸
  const md = planMarkdown({name, purposeLabel, platformLabel, audience, msg, moodLabel: palette.moodLabel, tones, palette, typo, grid, industry, keywords, imagery, bans, notes, cta, tagline});
  const html = `
    <h3>ê°œìš”</h3>
    <div class="notice">í”„ë¡œì íŠ¸: <b>${name}</b> Â· ëª©ì : <b>${purposeLabel}</b> Â· í”Œë«í¼: <b>${platformLabel}</b> Â· íƒ€ê²Ÿ: <b>${audience}</b></div>
    <h3>ì „ëµ ìš”ì•½</h3>
    <ul>
      <li>í•µì‹¬ ë©”ì‹œì§€: <b>${msg}</b></li>
      <li>í•µì‹¬ í‚¤ì›Œë“œ: ${keywords||'-'}</li>
      <li>í†¤ì•¤ë§¤ë„ˆ: ${tones}</li>
    </ul>
    <h3>ìƒ‰ì±„ íŒ”ë ˆíŠ¸</h3>
    <div class="swatch">${palette.colors.map(c=>`<div class="c"><div style="background:${c}"></div><span>${c.toUpperCase()}</span></div>`).join('')}</div>
    <div class="small">ë°°ê²½ ëŒ€ë¹„ ê¶Œì¥ì‚¬í•­: ë³¸ë¬¸ í…ìŠ¤íŠ¸ ëŒ€ë¹„ 4.5:1 ì´ìƒ ìœ ì§€</div>
    <h3>íƒ€ì´í¬ê·¸ë˜í”¼</h3>
    <ul>
      <li>ë³¸ë¬¸ ì„œì²´: ${typo.body}</li>
      <li>í—¤ë“œë¼ì¸ ì„œì²´: ${typo.head}</li>
      <li>ê¶Œì¥ ë¦¬ë”©(Line-height): ${typo.lead}</li>
    </ul>
    <h3>ë ˆì´ì•„ì›ƒ/ê·¸ë¦¬ë“œ</h3>
    <ul>${grid.map(g=>`<li>${g}</li>`).join('')}</ul>
    <h3>ì¹´í”¼/ë©”ì‹œì§€</h3>
    <ul>
      <li>CTA ì œì•ˆ: <b>${cta}</b></li>
      <li>íƒœê·¸ë¼ì¸ ì œì•ˆ: <b>${tagline}</b></li>
    </ul>
    <h3>ì´ë¯¸ì§€/ì•„ì´ì½˜ ë°©í–¥ (${industry})</h3>
    <ul>${(imagery||[]).map(s=>`<li>${s}</li>`).join('')}</ul>
    <h3>ì œì•½/ìš´ì˜</h3>
    <ul>
      <li>ê¸ˆì§€ ìš”ì†Œ: ${bans||'-'}</li>
      <li>ì ‘ê·¼ì„±/ìš´ì˜ ë©”ëª¨: ${notes||'-'}</li>
    </ul>
    <h3>ì¸ë„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
    <ul>
      <li>ìŠ¤íƒ€ì¼ ê°€ì´ë“œ: í‚¤ ì»¬ëŸ¬/íƒ€ì´í¬ ì²´ê³„/ê·¸ë¦¬ë“œ ê·œê²©</li>
      <li>ì›¹/ì•±: ì»´í¬ë„ŒíŠ¸ ìƒ˜í”Œ(ë²„íŠ¼/í¼/ì¹´ë“œ/í—¤ë”/í‘¸í„°)</li>
      <li>ë°°ë„ˆ/SNS: ê¸°ë³¸ í…œí”Œë¦¿ 3ì¢…(ì •ì‚¬ê°/ì„¸ë¡œ/ê°€ë¡œ)</li>
      <li>ì†ŒìŠ¤: ë²¡í„° ë¡œê³ , ì•„ì´ì½˜ SVG, ì´ë¯¸ì§€ ë¼ì´ì„ ìŠ¤ í‘œê¸°</li>
    </ul>
    <h3>ì›ë¬¸(ë³µì‚¬/ì €ì¥ìš© Markdown)</h3>
    <div class="code" id="mdBlock"></div>
  `;

  $('#plan').innerHTML = html;
  $('#mdBlock').textContent = md;
  $('#outSec').style.display='';
  window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'});
}

/* ì•¡ì…˜ */
function copyPlan(){
  const txt = $('#mdBlock').textContent;
  navigator.clipboard.writeText(txt).then(()=>{ alert('ê¸°íšì„œ(Markdown)ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'); });
}
function downloadMD(){
  const name = ($('#projName').value||'plan').replace(/[\\/:*?"<>|]/g,'-');
  const txt = $('#mdBlock').textContent;
  download(`${name}-concept.md`, txt);
}
function resetAll(){
  document.querySelectorAll('input,select').forEach(el=>{
    if(el.type==='color') el.value='#2563eb';
    else if(el.tagName==='SELECT') el.selectedIndex=0;
    else el.value='';
  });
  document.querySelectorAll('.chip.active').forEach(c=>c.classList.remove('active'));
  setSwatchesFromMood();
  $('#outSec').style.display='none';
}
</script>
</body>
</html>
